<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/bootstrap.css">
    <script src="jquery-3.3.1.js"></script>
    <script src="js/bootstrap.js"> </script>
</head>

<body class="container" style="margin-top: 20px">
    <!DOCTYPE html>
    <html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Page Title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/bootstrap.css">
        <script src="jquery-3.3.1.js"></script>
        <script src="js/bootstrap.js"> </script>
        <script src="jquery.csv.js"></script>
    </head>

    <body class="container" style="margin-top: 5px">
        <div class="jumbotron" style="color:red">
            <h2 style="text-align: center">
                STUDENT REGISTRATION FORM
            </h2>
        </div>
        <form class="form-horizontal" data-toggle="validator">
            <div class="form-group">
                <label for="inputName" class="col-sm-2 control-label" style="text-align: center">Enter Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputName" placeholder="Enter Name" required>
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail" class="col-sm-2 control-label" style="text-align: center">Enter Email Id</label>
                <div class="col-sm-10">
                    <input type="email" class="form-control" id="inputEmail" placeholder="Enter Email Id" required>
                </div>
            </div>
            <div class="form-group">
                <label for="inputRollNo" class="col-sm-2 control-label" style="text-align: center">Enter Roll No</label>
                <div class="col-sm-10">
                    <input type="number" class="form-control" id="inputRollNO" placeholder="Enter Roll No">
                </div>
            </div>

            <div class="form-group">
                <label for="inputAge" class="col-sm-2 control-label" style="text-align: center">Enter Age</label>
                <div class="col-sm-10">
                    <input type="number" class="form-control" id="inputAge" placeholder="Enter Age">
                </div>
            </div>

            <div class="form-group">
                <label for="inputDate" class="col-sm-2 control-label" style="text-align: center">Enter Date</label>
                <div class="col-sm-10">
                    <input type="date" class="form-control" id="inputDate" placeholder="Enter Date" required>
                </div>
            </div>
            <div class="form-group">
                <label>
                    <input type="radio" style="margin-left: 210px" name="optionsRadios" id="genderMale" value="option1"
                        checked>
                    MALE
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="radio" style="margin-left: 210px" name="optionsRadios" id="genderFemale"
                        value="option2">
                    FEMALE
                </label>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <input type="submit" id="addButton" class="btn btn-primary" value="Add"></button>
                    <span id="error" style="color:red"></span>
                    <input type="button" id="displayButton" class="btn btn-primary" value="Display"></button>
                </div>
            </div>
            <div id="print">
            </div>
            <div id="loading">
                <img id="loading-image" src="colourfulimage.gif" alt="Loading..." />
            </div>
            <div id="table"></div>
            <script>
                var objlist = [];
                $("#displayButton").on('click', function () {
                    $('#loading-image').show();
                    $.ajax({
                        url: "http://gsmktg.azurewebsites.net/api/v1/techlabs/test/students/",
                        type: "get",
                        success: function (data) {
                            setTimeout(function () {
                                getInfo(data);
                                createTable(data);
                                $('#loading-image').hide();
                            }, 2000)
                        },
                        error: function () {
                            $("#loading-image").hide();
                            $("#print").html("Network error please try again");
                        }
                    })
                })
                function createTable(data) {
                    var result = data;
                    var string;
                    string = "<table class='table table-striped'>";
                    string += "<th>Roll Number</th><th>Student name</th> <th>Age </th> <th>Date</th> <th>Email</th>";
                    for (var i = 0; i < result.length; i++) {
                        var email = result[i].email;
                        var rollNumber = result[i].rollNo;
                        var name = result[i].name;
                        var age = result[i].age;
                        var date = result[i].date;
                        string += '<tr>';
                        string += "<td>" + rollNumber + "</td>";
                        string += "<td>" + name + "</td>";
                        string += "<td>" + age + "</td>";
                        string += "<td>" + date + "</td>";
                        string += "<td>" + email + "</td>";
                        //string += "<td>" + "<input type='button' value='Delete' id='deleteButton' class='btn btn-danger'>" + "</td>";
                        string += "</tr>";
                    }
                    string += "</table>";
                    $("#table").html(string);
                    console.log(string);
                }
                
                $("#addButton").submit(function () {
                    $.post("http://gsmktg.azurewebsites.net/api/v1/techlabs/test/students/", {
                        "Name": $("#inputName").val(),
                        "Email": $("#inputEmail").val(),
                        "Roll-No": $("#inputRollNO").val(),
                        "Age": $("#inputAge").val(),
                        "Date": $("#inputDate").val(),
                        "isMale": $("#genderMale").prop('checked')
                    },
                        function (data, status) {
                            alert("Data: " + data + "\nStatus: " + status);
                        });
                });
                function getInfo(data) {
                    console.log(data);
                }
                $(document).ready(function () {
                    $('#loading-image').hide();
                });
            </script>
        </form>
    </body>

    </html>